<!-- Supabase Authentication Modal -->
<!-- PhotoToBlog v3 êµ¬ë… í”„ë¡œì íŠ¸ -->

<div id="authModal" class="auth-modal">
    <div class="auth-modal-content">
        <form id="authForm" class="auth-form" novalidate>
            <h2 id="authTitle">ë¡œê·¸ì¸</h2>
            
            <!-- Error Message -->
            <div id="authError" class="auth-error" style="display: none;"></div>
            
            <!-- Email Input -->
            <div class="form-group">
                <label for="authEmail">ì´ë©”ì¼ ì£¼ì†Œ</label>
                <input 
                    type="email" 
                    id="authEmail" 
                    class="input" 
                    required 
                    placeholder="your@email.com"
                    autocomplete="email"
                >
            </div>
            
            <!-- Password Input -->
            <div class="form-group">
                <label for="authPassword">ë¹„ë°€ë²ˆí˜¸</label>
                <input 
                    type="password" 
                    id="authPassword" 
                    class="input" 
                    required 
                    placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                    autocomplete="current-password"
                    minlength="6"
                >
            </div>
            
            <!-- Submit Button -->
            <button type="submit" id="authSubmit" class="btn btn-primary">
                ë¡œê·¸ì¸
            </button>
            
            <!-- Mode Toggle -->
            <div style="text-align: center; margin-top: 1rem;">
                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                    ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? 
                    <a href="#" id="toggleAuthMode" style="color: var(--primary-color); text-decoration: none;">íšŒì›ê°€ì…</a>
                </p>
            </div>
            
            <!-- Close Button -->
            <button type="button" id="closeAuthModal" class="btn btn-secondary" style="margin-top: 1rem;">
                ì·¨ì†Œ
            </button>
        </form>
    </div>
</div>

<!-- Additional Info Section (Optional) -->
<div id="authInfo" style="display: none;">
    <div style="margin-top: 1rem; padding: 1rem; background: var(--surface); border-radius: 8px; border: 1px solid var(--border);">
        <h4 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 0.9rem;">
            ğŸ¯ ì„œë¹„ìŠ¤ ì´ìš© ì•ˆë‚´
        </h4>
        <ul style="font-size: 0.8rem; color: var(--text-secondary); line-height: 1.5; padding-left: 1rem;">
            <li>ë¬´ë£Œ ì‚¬ìš©ì: ê¸°ë³¸ AI ë¸”ë¡œê·¸ ìƒì„± ê¸°ëŠ¥</li>
            <li>í”„ë¦¬ë¯¸ì—„ ì‚¬ìš©ì: ê³ ê¸‰ í¸ì§‘, ë‹¤ì–‘í•œ í…œí”Œë¦¿, ìš°ì„  ì²˜ë¦¬</li>
            <li>ëª¨ë“  ê³„ì •ì€ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”ë˜ì–´ ë³´í˜¸ë©ë‹ˆë‹¤</li>
        </ul>
    </div>
</div>

<script>
// ëª¨ë‹¬ HTMLì´ ë¡œë“œë˜ë©´ ì¸ì¦ ì‹œìŠ¤í…œ ì—°ê²°
document.addEventListener('DOMContentLoaded', function() {
    // ì¶”ê°€ ì •ë³´ í† ê¸€ ê¸°ëŠ¥
    const toggleInfo = document.createElement('button');
    toggleInfo.textContent = 'ì„œë¹„ìŠ¤ ì•ˆë‚´';
    toggleInfo.className = 'btn btn-secondary btn-small';
    toggleInfo.style.cssText = 'margin-top: 0.5rem; font-size: 0.8rem;';
    
    const authForm = document.getElementById('authForm');
    if (authForm) {
        authForm.appendChild(toggleInfo);
        
        toggleInfo.addEventListener('click', (e) => {
            e.preventDefault();
            const authInfo = document.getElementById('authInfo');
            if (authInfo) {
                authInfo.style.display = authInfo.style.display === 'none' ? 'block' : 'none';
            }
        });
    }

    // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            const authModal = document.getElementById('authModal');
            if (authModal && authModal.classList.contains('show')) {
                if (window.authManager) {
                    window.authManager.hideAuthModal();
                }
            }
        }
    });

    // í¼ ìœ íš¨ì„± ê²€ì‚¬ ê°œì„ 
    const authEmailInput = document.getElementById('authEmail');
    const authPasswordInput = document.getElementById('authPassword');
    
    if (authEmailInput) {
        authEmailInput.addEventListener('blur', validateEmail);
        authEmailInput.addEventListener('input', clearEmailError);
    }
    
    if (authPasswordInput) {
        authPasswordInput.addEventListener('blur', validatePassword);
        authPasswordInput.addEventListener('input', clearPasswordError);
    }

    function validateEmail() {
        const email = authEmailInput.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (email && !emailRegex.test(email)) {
            authEmailInput.setCustomValidity('ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            authEmailInput.style.borderColor = 'var(--error-color)';
        } else {
            authEmailInput.setCustomValidity('');
            authEmailInput.style.borderColor = '';
        }
    }

    function validatePassword() {
        const password = authPasswordInput.value;
        
        if (password && password.length < 6) {
            authPasswordInput.setCustomValidity('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
            authPasswordInput.style.borderColor = 'var(--error-color)';
        } else {
            authPasswordInput.setCustomValidity('');
            authPasswordInput.style.borderColor = '';
        }
    }

    function clearEmailError() {
        authEmailInput.style.borderColor = '';
        authEmailInput.setCustomValidity('');
    }

    function clearPasswordError() {
        authPasswordInput.style.borderColor = '';
        authPasswordInput.setCustomValidity('');
    }
});
</script>